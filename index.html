<!DOCTYPE html>
<html lang="ro" data-bs-theme="dark">
<head>
  <meta charset="UTF-8" />
  <title>Gym Log Pro - Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <!-- CSS Custom -->
  <link rel="stylesheet" href="style.css">

  <!-- JS Libraries (D3, jsPDF) - le lăsăm aici deocamdată -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>

</head>
<body>

<!-- Container Toast -->
<div class="toast-container position-fixed top-0 end-0 p-3">
    <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header"><strong class="me-auto" id="toastTitle">Notificare</strong><button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button></div>
        <div class="toast-body" id="toastBody">Mesaj.</div>
    </div>
</div>

<div class="container main-content">

    <!-- ==================== Tab Content: Log ==================== -->
    <div id="logTabContent" class="tab-content active">
        <h1 class="my-4 text-center display-6">Jurnal Antrenamente</h1>

        <!-- Formular Adăugare/Editare -->
        <div class="form-section">
            <h2 id="formTitle" class="mb-4 fs-5">Adaugă Exercițiu Nou</h2>
            <form id="workoutForm" class="row g-3 needs-validation" novalidate>
                <input type="hidden" id="editId" name="editId">
                 <div class="col-md-4">
                    <label for="date" class="form-label">Data</label>
                    <input type="date" class="form-control form-control-sm" id="date" name="date" required />
                    <div class="invalid-feedback">Data este obligatorie.</div>
                 </div>
                 <div class="col-md-4">
                    <label for="exercise" class="form-label">Exercițiu</label>
                    <select class="form-select form-select-sm" id="exercise" name="exercise" required>
                        <option value="" selected disabled>Alegeți...</option>
                    </select>
                    <div class="invalid-feedback">Exercițiul este obligatoriu.</div>
                 </div>
                 <div class="col-md-4">
                     <label for="muscleGroups" class="form-label">Grupe Musculare</label>
                     <select class="form-select form-select-sm" id="muscleGroups" name="muscleGroups" multiple required>
                         <option value="Piept">Piept</option><option value="Spate">Spate</option><option value="Umeri">Umeri</option><option value="Biceps">Biceps</option><option value="Triceps">Triceps</option><option value="Cvadriceps">Cvadriceps</option><option value="Femurali">Femurali</option><option value="Fesieri">Fesieri</option><option value="Gambe">Gambe</option><option value="Abdomen">Abdomen</option><option value="Antebraț">Antebraț</option><option value="Full Body">Full Body</option><option value="Cardio">Cardio</option>
                     </select>
                     <div class="form-text" style="font-size: 0.75rem;">Ctrl/Cmd + click pt. selecție multiplă.</div>
                     <div class="invalid-feedback">Selectați cel puțin o grupă.</div>
                 </div>
                <!-- Seturi -->
                <div class="col-12 mt-3">
                    <label class="form-label fw-bold">Seturi:</label>
                    <div id="setsContainer" class="mb-2">
                    <div class="alert alert-warning d-none p-2" id="setsWarning">Adăugați cel puțin un set valid.</div>
                    </div>
                    <button type="button" class="btn btn-outline-secondary btn-sm" id="addSetBtn">+ Adaugă Set</button>
                </div>
                <!-- Notițe -->
                <div class="col-12 mt-3">
                    <label for="notes" class="form-label">Notițe</label>
                    <textarea class="form-control form-control-sm" id="notes" name="notes" rows="2"></textarea>
                </div>
                <!-- Butoane Formular -->
                <div class="col-12 mt-4 d-flex gap-2">
                    <button type="submit" class="btn btn-primary" id="submitBtn">Adaugă Exercițiu</button>
                    <button type="button" class="btn btn-secondary d-none" id="cancelEditBtn">Anulează Editarea</button>
                </div>
            </form>
        </div>

        <!-- Controale Tabel (Filtre, Export) -->
        <div class="table-controls row g-2 align-items-center">
             <div class="col-lg col-md-4 col-sm-6"> <input type="date" id="filterDate" class="form-control form-control-sm" title="Filtrează după dată"> </div>
             <div class="col-lg col-md-4 col-sm-6"> <input type="text" id="filterExercise" class="form-control form-control-sm" placeholder="Filtrează exercițiu..."> </div>
             <div class="col-lg col-md-4 col-sm-6"> <select id="filterMuscleGroup" class="form-select form-select-sm"> <option value="">Filtrează grupă...</option> </select> </div>
             <div class="col-lg col-md-12 col-sm-6 text-lg-end mt-2 mt-lg-0"> <div class="btn-group btn-group-sm me-2" role="group"> <button id="exportCSV" class="btn btn-outline-success" title="Export CSV">CSV</button> <button id="exportTXT" class="btn btn-outline-secondary" title="Export TXT">TXT</button> <button id="exportPDF" class="btn btn-outline-danger" title="Export PDF">PDF</button> </div> <button id="clearFilters" class="btn btn-warning btn-sm" title="Șterge Filtre">Reset</button> </div>
        </div>

        <!-- Tabel Antrenamente -->
        <div class="workout-table-container table-responsive mt-3">
            <table class="table table-striped table-hover table-sm" id="workoutTable">
                <thead class="table-light">
                    <tr>
                        <th data-column="date">Data <span class="sort-icon"></span></th>
                        <th data-column="exercise">Exercițiu <span class="sort-icon"></span></th>
                        <th data-column="muscleGroups">Grupe <span class="sort-icon"></span></th>
                        <th data-column="sets" class="text-center">Seturi <span class="sort-icon"></span></th>
                        <th class="text-center">Repetări</th>
                        <th class="text-center">Greutate</th>
                        <th data-column="volume" class="text-end">Volum <span class="sort-icon"></span></th>
                        <th data-column="e1rm" class="text-end">e1RM Max <span class="sort-icon"></span></th>
                        <th>Notițe</th>
                        <th>Acțiuni</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <p id="noDataMessage" class="text-center text-muted d-none mt-3">Nu există date de afișat.</p>
        </div>

         <!-- Grafice Progres (opțional, pot fi mutate la Dashboard) -->
         <div class="row gx-4 mt-4">
            <div class="col-lg-6">
                <div class="chart-container">
                    <div class="chart-title">Volum Total Agregat per Exercițiu (All Time)</div>
                    <svg id="d3VolumeChart" width="100%" height="320"></svg>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="chart-container">
                    <div class="chart-title">Progres Exercițiu Selectat</div>
                    <div class="mb-3 px-2"> <select id="progressExerciseSelect" class="form-select form-select-sm"> <option value="">Alege un exercițiu...</option> </select> </div>
                    <svg id="d3ProgressChart" width="100%" height="275"></svg>
                </div>
            </div>
         </div>

    </div><!-- Sfârșit #logTabContent -->

    <!-- ==================== Tab Content: Dashboard ==================== -->
    <div id="dashboardTabContent" class="tab-content">
        <div class="dashboard-header">
            <h1 class="display-6">Statistici</h1>
            <select class="form-select form-select-sm w-auto" id="dashboardPeriodSelect">
                <option value="last7days" selected>Ultimele 7 zile</option>
                <option value="last30days">Ultimele 30 zile</option>
                <option value="allTime">Tot timpul</option>
            </select>
        </div>

        <!-- Secțiune Medie Antrenament -->
        <div class="dashboard-section">
            <h2>Medie Antrenament (Forță)</h2>
            <div class="stats-grid">
                <div class="stat-item"> <span class="value" id="statsExercises">0</span> <span class="label">Exerciții</span> </div>
                <div class="stat-item"> <span class="value" id="statsSets">0</span> <span class="label">Seturi</span> </div>
                <div class="stat-item"> <span class="value" id="statsReps">0</span> <span class="label">Repetări</span> </div>
                <div class="stat-item"> <span class="value" id="statsAvgWeight">0</span> <span class="label">Greutate Medie (kg)</span> </div>
                <div class="stat-item"> <span class="value" id="statsTotalVolume">0</span> <span class="label">Volum Total (T)</span> </div>
                <!-- <div class="stat-item"> <span class="value" id="statsTime">00:00</span> <span class="label">Timp</span> </div> -->
            </div>
        </div>

        <!-- Secțiune Medie Săptămânală -->
        <div class="dashboard-section">
            <h2>Medie Săptămânală</h2>
             <div class="stats-grid">
                <div class="stat-item"> <span class="value" id="weeklyAvgWorkouts">0</span> <span class="label">Antrenamente / Săpt</span> </div>
                <div class="stat-item"> <span class="value" id="weeklyAvgSets">0</span> <span class="label">Seturi / Săpt</span> </div>
                <div class="stat-item"> <span class="value" id="weeklyAvgReps">0</span> <span class="label">Repetări / Săpt</span> </div>
                 <div class="stat-item"> <span class="value" id="weeklyAvgRepsPerSet">0</span> <span class="label">Repetări / Set</span> </div>
                 <div class="stat-item"> <span class="value" id="weeklyAvgVolume">0</span> <span class="label">Volum / Săpt (T)</span> </div>
                 <!-- <div class="stat-item"> <span class="value" id="weeklyAvgTime">00:00</span> <span class="label">Timp / Săpt</span> </div> -->
            </div>
        </div>

        <!-- Secțiune Grupe Musculare -->
        <div class="dashboard-section">
            <h2>Grupe Musculare Lucrate</h2>
            <div class="chart-container" id="musclesWorkedChartContainer">
                <svg id="d3MusclesChart" width="100%" height="250"></svg>
                <p id="noMuscleDataMessage" class="text-center text-muted d-none mt-3">Nu există date despre grupele musculare pentru perioada selectată.</p>
            </div>
        </div>

    </div><!-- Sfârșit #dashboardTabContent -->

    <!-- ==================== Tab Content: Setări ==================== -->
    <div id="settingsTabContent" class="tab-content">
        <h1 class="my-4 text-center display-6">Setări & Date</h1>

        <!-- Gestionare Exerciții -->
        <div class="form-section">
             <h2 class="mb-4 fs-5">Gestionează Lista de Exerciții</h2>
             <div class="mb-3">
                <label for="newExerciseNameSettings" class="form-label">Adaugă exercițiu nou:</label>
                <div class="input-group input-group-sm">
                  <input type="text" class="form-control" id="newExerciseNameSettings" placeholder="Nume exercițiu nou">
                  <button class="btn btn-success" type="button" id="addNewExerciseBtnSettings">Adaugă</button>
                </div>
             </div>
             <div>
                 <label class="form-label">Exerciții adăugate de tine:</label>
                 <ul id="existingExercisesListSettings" class="list-group list-group-flush list-group-sm"></ul>
             </div>
        </div>

        <!-- Backup & Restore -->
        <div class="backup-restore-section form-section">
            <h2 class="mb-4 fs-5">Backup & Restaurare Date</h2>
            <p class="form-text mb-3">Salvează sau încarcă toate datele aplicației (antrenamente, exerciții custom, recorduri).</p>
            <div class="d-flex gap-2 flex-wrap">
                <button class="btn btn-info btn-sm" id="backupDataBtnSettings">Descarcă Backup</button>
                <label for="restoreFileSettings" class="btn btn-warning btn-sm custom-file-upload">Încarcă Backup</label>
                <input type="file" id="restoreFileSettings" accept=".json">
            </div>
        </div>

    </div><!-- Sfârșit #settingsTabContent -->

</div><!-- Sfârșit .main-content -->


<!-- ==================== Navigare Inferioară ==================== -->
<nav id="bottomNav">
    <button id="logTabBtn" class="active" data-target="logTabContent" title="Jurnal">
        <i class="bi bi-list-task"></i>
        <span>Jurnal</span>
    </button>
    <button id="dashboardTabBtn" data-target="dashboardTabContent" title="Dashboard">
        <i class="bi bi-bar-chart-line-fill"></i>
        <span>Dashboard</span>
    </button>
    <button id="settingsTabBtn" data-target="settingsTabContent" title="Setări">
        <i class="bi bi-gear-fill"></i>
        <span>Setări</span>
    </button>
</nav>

<!-- JS Dependencies -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<script src="app.js"></script>

</body>
</html>
